# Criptograf√≠a

## ¬øPor qu√© cifrar?

- La informaci√≥n es muy importante. Imagina: planos, dinero, documentos personales o de empresa, fotos, ...
- Actualmente la informaci√≥n viaja a trav√©s de redes inform√°ticas, de Internet, y alguien podr√≠a interceptarla.

## Introducci√≥n a la Criptograf√≠a

- Criptograf√≠a viene del griego cripto (que significa ¬´ocultar¬ª) y graphos (que significa ¬´escribir¬ª).
- Para poder cifrar y descifrar debemos seguir una "reglas". Esas reglas son el llamado **algoritmo**.
- Un mismo algoritmo da diferentes mensajes cifrados. Para lograrlo debemos usar diferentes **claves**.
- Consideraciones sobre las claves:
  - Alguien puede intentar averiguarlas: ataques de **fueza bruta** (todas las combinaciones posibles) y ataques de **diccionario** (es decir usando claves, palabras, que alguien ha recopilado como posibles claves).
  - Cuanto m√°s larga m√°s dif√≠cil de averiguar
  - Cuanto mayor n√∫mero de caracteres se usan m√°s dif√≠cil de averiguar
  - Es conveniente cambiarla regularmente
  - No debemos usar palabras identificables.
  - Una medida de seguridad es bloquear cuentras si hay intentos repetidos.

### El origen. Cifrado C√©sar

- El primer algoritmo de cifrado fue usado por el general romano Julio Cesar.
- Es un cifrado simple por sustituci√≥n. Cada caracter se sustituye por el que ocupa "N" posiciones m√°s adelante en el alfabeto.
- T√≠picamente el desplazamiento es N=3, pero puede ser cualqier n√∫mero entre 1 y 25.
- La tabla de sustituci√≥n para N=3 es:

```
A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
D E F G H I J K L M N O P Q R S T U V W X Y Z A B C
```

- As√≠ "Santiago Hernandez" se cifrar√≠a como "Xfsyfnlt Mjwsfsije"
- Prueba a cifrar "Zaragoza" con desplzamiento 3 y con desplazamiento 6


## Criptograf√≠a sim√©trica

- Damos ese nombre a los algoritmos que usan la misma clave para codificar y para decodificar los mensajes. 
- Sencillos de usar y r√°pidos. Hasta los a√±os 70 todos eran as√≠.
- El primero conocido: C√©sar. La clave es el desplazamiento N.
- M√°s modernos: DES, 3DES, AES, Blowfish e IDEA.
- Ejemplo: telefon√≠a SIM.
  - La tarjeta SIM tiene un identificador √∫nico, un *dni* y una clave de cifrado.
  - El proveeror (Movistar, Vodafone,...) conoce el identificador y la clave de cifrado.
  - Toda la comunicaci√≥n es cifrada y descifrada usando la clave que ambos conocen.
  - La tarjeta SIM es la que cifra (y descifra) la comunicaci√≥n, no es el tel√©fono. La clave no puede ser averiguada.
- Sencillo y eficiente. 
- **La dificultad principal es el intercambio de claves**.
- Principales algoritmos: DES, 3DES, **AES** (AES256, AES192, AES128), Blowfish e IDEA.


> **Explicaci√≥n m√°s detallada algoritmo AES**
>
> - AES cifra usando claves de 128, 192 o 256 bits. Por comparar, una IPv4 es una cadena de 32bits. Una IPv6 es de 128.
> - Sin embargo nosotros le damos una contrase√±a de longitud aleatoria. 
> 
> ¬øC√≥mo funciona todo esto?
> 
> - La contrase√±a dada y una cadena aleatoria, inventada al azar. Se pasan por un algoritmo que genera una clave aleatora de 128, 192 o 256bit. Cuanto m√°s larga m√°s segura.
> - La clave obtenida es la que realmente se usa para cifrar.
> - El fichero resultado, lleva una parte no cifrada: el algoritmo usado, y la cadena aleatoria a la que se le llama sal o *salt* en ingl√©s.
> - Si no usaramos esa "sal", la clave de cifrado de una contrase√±a ser√≠a siempre igual y ser√≠a f√°cil hacer ataques por diccionario.
> - Al descifrar, se usa la contrase√±a dada y la sal para calcular la clave de cifrado y descifrar el mensaje.

- V√≠deo: Criptograf√≠a sim√©trica: https://www.youtube.com/watch?v=SlSmI18T2Ns&list=PLG1hKOHdoXkt1V51gyPMZqgQ8LjK3LfmJ&index=2


## Criptograf√≠a asim√©trica


- La criptograf√≠a sim√©trica tiene un gran inconveniente: ¬øc√≥mo intercambiamos las claves de forma segura?
- La criptograf√≠a **asim√©trica** se invent√≥ en los a√±os 70 para resolver este problema. El primer algoritmo de este tipo se llama Diffie-Hellman por el apellido de los autores. En 2015 recibieron el premio Touring, algo as√≠ como el *Nobel de inform√°tica*.
- Est√° basada en c√°lculos matem√°ticos que van m√°s all√° de nuesta capacidad.
- Lo importante:
  - No hay una clave sino una pareja de claves. Estas claves son n√∫meros relacionados matem√°ticamente.
  - Si usamos una para cifrar, debemos descifrar con la otra (y viceversa)
  - Una de ellas se etiqueta como p√∫blica y la otra como privada. La p√∫blica se la podemos entregar a cualquiera y no pone en peligro nuestra seguridad. Incluso podemos publicarla en Internet
- La parte mala:
  - Los c√°lculos de cifrar y descifrar son m√°s largos y necesitan m√°s tiempo.
  - Por ese motivo, no podemos usar estas claves para cifrarlo todo
  - Adem√°s si hubiera muchos mensajes cifrados con esas claves se podr√≠a poner en peligro la seguridad del sistema.
  - Las claves se guardan en un fichero especial protegido con contrase√±a (es decir, cifrado sim√©trico).
- La parte mala:
  - S√≠ podemos usarla para intercambiar claves sim√©tricas de forma segura
  - De esta manera el esquema habitual de las comunicaciones es mixto: se usan claves sim√©tricas para cifrar la comunicaci√≥n. Antes de comenzar dicha comunicaci√≥n se intercambia la clave sim√©trica usando cifrado asim√©trico.
- V√≠deo: Criptograf√≠a asim√©trica: https://www.youtube.com/watch?v=SIIqLgqRMCo&list=PLG1hKOHdoXkt1V51gyPMZqgQ8LjK3LfmJ&index=3


## Hash (fingerprint, huella dactilar)

### ¬øQu√© es un *hash*?

Un **hash** es un resumen o huella digital de un dato (por ejemplo, un archivo o una contrase√±a).
Se genera con una **funci√≥n matem√°tica** que siempre produce el mismo resultado para la misma entrada, pero **no permite obtener el original a partir del hash**.

> Es como una huella dactilar: identifica algo de forma √∫nica, pero no permite reconstruir la persona.

---

### Ejemplo 1: Verificaci√≥n de un archivo ISO

Cuando descargas una imagen ISO de Ubuntu, puedes comprobar que no se ha modificado comparando su *hash* con el oficial.

```bash
sha256sum ubuntu-24.04.iso
```

Esto genera algo as√≠ como:

```
e5b72c4b71d89a7ad5c2d7c3f6a6a9bfae3d1b8d9c64b83b97d6b7f8b9e3c92e  ubuntu-24.04.iso
```

Luego comparas ese valor con el que aparece en la web oficial de Ubuntu:
üëâ [https://releases.ubuntu.com/24.04/SHA256SUMS](https://releases.ubuntu.com/24.04/SHA256SUMS)

Si coinciden, el archivo no ha sido alterado.

---

### Ejemplo 2: Hash de una contrase√±a sencilla

Puedes crear un hash de una contrase√±a con:

```bash
echo -n "123456" | sha256sum
```

Y obtendr√°s algo como:

```
8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92  -
```

---

### Ejemplo 3: B√∫squeda por diccionario (*cracking* de hashes)

Muchos atacantes intentan adivinar contrase√±as probando *hashes* conocidos de palabras comunes o contrase√±as d√©biles.
Puedes probar a buscar el hash anterior (por ejemplo `8d969eef6eca...`) en un buscador de hashes para ver si se corresponde con una contrase√±a conocida.

Una web segura y educativa para hacerlo es:
üîó [https://crackstation.net/](https://crackstation.net/)

(Permite buscar hashes y muestra si pertenecen a contrase√±as comunes o de diccionarios.)

## Cifrar y firmar

- C√≥mo hacerlo:
  - Cifrado asim√©trico con gpg: https://www.youtube.com/watch?v=HRK0CqrWUjI
  - Firmar documentos con gpg: https://www.youtube.com/watch?v=9gdXvAT2q-4
  - Tutorial firma digital: https://chatgpt.com/s/t_68e44b7bbe148191bf26f3c2de315de0

### hash

- Qu√© es un hash: https://www.youtube.com/watch?v=it9suW1HN3Q&list=PLG1hKOHdoXkt1V51gyPMZqgQ8LjK3LfmJ&index=4

## PKI, DNIe



## V√≠deos interesantes:

Repetimos los v√≠deos que pueden ser interesantes:

- Criptograf√≠a cifrado sim√©trico: https://www.youtube.com/watch?v=SlSmI18T2Ns&list=PLG1hKOHdoXkt1V51gyPMZqgQ8LjK3LfmJ&index=2
- Criptograf√≠a cifrado asim√©trico: https://www.youtube.com/watch?v=SIIqLgqRMCo&list=PLG1hKOHdoXkt1V51gyPMZqgQ8LjK3LfmJ&index=3
- Qu√© es un hash: https://www.youtube.com/watch?v=it9suW1HN3Q&list=PLG1hKOHdoXkt1V51gyPMZqgQ8LjK3LfmJ&index=4
- Cifrado asim√©trico con gpg: https://www.youtube.com/watch?v=HRK0CqrWUjI
- Firmar documentos con gpg: https://www.youtube.com/watch?v=9gdXvAT2q-4
